<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Number Memory Challenge</title>
		<style>
			:root {
				--bg-color: #282c34;
				--text-color: #abb2bf;
				--container-bg: #1e2127;
				--border-color: #444;
				--primary-color: #61afef;
				--correct-color: #98c379;
				--incorrect-color: #e06c75;
				--button-bg: #5c6370;
				--button-hover-bg: #7b8493;
				--input-bg: #3e4451;
				--input-focus-shadow: #61afef;
			}

			body {
				font-family: "Courier New", monospace;
				background-color: var(--bg-color);
				color: var(--text-color);
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				min-height: 100vh;
				margin: 0;
				padding: 20px;
				box-sizing: border-box;
			}

			.container {
				max-width: 600px;
				width: 100%;
				text-align: center;
				background-color: var(--container-bg);
				padding: 30px 40px;
				border-radius: 10px;
				box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
				border: 1px solid var(--border-color);
			}

			h1 {
				color: var(--primary-color);
				margin-bottom: 5px;
			}

			.info-panel {
				margin: 20px 0;
				padding: 15px;
				background-color: var(--pi-display-bg);
				border-radius: 5px;
				border: 1px solid var(--border-color);
			}

			#number-display {
				font-size: 3em;
				margin: 20px 0;
				min-height: 1.5em;
				text-align: center;
				font-weight: bold;
			}

			#input-container {
				display: flex;
				flex-direction: column;
				align-items: center;
				gap: 15px;
			}

			#number-input {
				font-family: "Courier New", monospace;
				font-size: 1.5em;
				width: 80%;
				max-width: 300px;
				text-align: center;
				padding: 10px;
				border-radius: 5px;
				border: 1px solid var(--primary-color);
				background-color: var(--input-bg);
				color: var(--text-color);
				caret-color: var(--primary-color);
				outline: none;
				transition: box-shadow 0.3s;
			}

			#number-input:focus {
				box-shadow: 0 0 8px var(--input-focus-shadow);
			}

			button {
				padding: 10px 20px;
				font-size: 1.1em;
				background-color: var(--primary-color);
				color: #fff;
				border: none;
				border-radius: 5px;
				cursor: pointer;
				transition: background-color 0.3s;
			}

			button:hover {
				background-color: #4b88c7;
			}

			#status-message {
				margin-top: 20px;
				font-size: 1.2em;
				min-height: 1.2em;
				font-weight: bold;
			}

			.correct-text {
				color: var(--correct-color);
			}

			.incorrect-text {
				color: var(--incorrect-color);
			}

			.hidden {
				display: none;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<h1>Number Memory Challenge</h1>
			<div class="info-panel">
				<p>
					Memorize the sequence of numbers that appear, then type it
					in and submit. The sequence gets longer each round.
				</p>
			</div>

			<div id="number-display"></div>

			<div id="game-area">
				<div id="input-container">
					<input
						type="text"
						id="number-input"
						placeholder="Type the number"
						autocomplete="off"
						disabled
					/>
					<button id="submit-button">Submit</button>
				</div>
				<button id="start-button">Start Game</button>
			</div>

			<div id="status-message"></div>

			<div id="score-panel">
				<h2>Current Level: <span id="current-level">0</span></h2>
				<h2>High Score: <span id="high-score">0</span></h2>
			</div>
		</div>

		<script>
			const numberDisplay = document.getElementById("number-display");
			const numberInput = document.getElementById("number-input");
			const startButton = document.getElementById("start-button");
			const submitButton = document.getElementById("submit-button");
			const statusMessage = document.getElementById("status-message");
			const currentLevelSpan = document.getElementById("current-level");
			const highScoreSpan = document.getElementById("high-score");
			const inputContainer = document.getElementById("input-container");

			let currentSequence = [];
			let level = 0;
			let isMemorizingPhase = false;
			let highScore = localStorage.getItem("numberMemoryHighScore") || 0;

			highScoreSpan.textContent = highScore;

			function generateSequence(length) {
				currentSequence = [];
				for (let i = 0; i < length; i++) {
					// Ensure the first digit is not zero to avoid leading zeros confusion
					if (i === 0) {
						currentSequence.push(Math.floor(Math.random() * 9) + 1);
					} else {
						currentSequence.push(Math.floor(Math.random() * 10));
					}
				}
				return currentSequence.join("");
			}

			function showSequence() {
				isMemorizingPhase = true;
				statusMessage.textContent = "Memorize this...";
				numberDisplay.textContent = generateSequence(level);

				// Set input to disabled and buttons to hide
				numberInput.disabled = true;
				inputContainer.style.display = "none";

				// Hide the number after a few seconds
				setTimeout(() => {
					numberDisplay.textContent = "";
					statusMessage.textContent = "Now, enter the sequence.";
					numberInput.disabled = false;
					inputContainer.style.display = "flex";
					numberInput.focus();
					isMemorizingPhase = false;
				}, level * 1000 + 1000); // Wait longer for longer sequences
			}

			function checkInput() {
				if (isMemorizingPhase) return;

				const userInput = numberInput.value;
				const correctSequence = currentSequence.join("");

				if (userInput === correctSequence) {
					statusMessage.textContent = "Correct!";
					statusMessage.className = "correct-text";
					level++;
					currentLevelSpan.textContent = level;
					numberInput.value = "";

					// Update high score
					if (level > highScore) {
						highScore = level;
						highScoreSpan.textContent = highScore;
						localStorage.setItem(
							"numberMemoryHighScore",
							highScore
						);
					}

					setTimeout(showSequence, 1500);
				} else {
					statusMessage.textContent = `Game Over! You reached level ${level}. The correct sequence was ${correctSequence}.`;
					statusMessage.className = "incorrect-text";
					numberInput.disabled = true;
					submitButton.style.display = "none";
					startButton.style.display = "block";
					level = 0;
				}
			}

			function startGame() {
				level = 1;
				currentLevelSpan.textContent = level;
				statusMessage.textContent = "";
				numberInput.value = "";
				startButton.style.display = "none";
				submitButton.style.display = "block";
				showSequence();
			}

			startButton.addEventListener("click", startGame);
			submitButton.addEventListener("click", checkInput);
			numberInput.addEventListener("keydown", (event) => {
				if (event.key === "Enter") {
					checkInput();
				}
			});

			// Initial state
			inputContainer.style.display = "none";
			submitButton.style.display = "none";
			currentLevelSpan.textContent = 0;
		</script>
	</body>
</html>
